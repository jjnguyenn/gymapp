"use strict";(self.webpackChunkgym_buddy=self.webpackChunkgym_buddy||[]).push([[816],{435:(e,t,r)=>{r.r(t),r.d(t,{default:()=>i});var s=r(43),a=r(447),l=r(472),o=r(948),n=r(579);const i=function(){const{user:e,isAuthenticated:t,isLoading:r}=(0,a.WB)(),[i,c]=(0,s.useState)(""),[d,u]=(0,s.useState)(""),[g,m]=(0,s.useState)(""),[h,b]=(0,s.useState)(""),[x,p]=(0,s.useState)(""),[y,w]=(0,s.useState)("kg"),[k,j]=(0,s.useState)([]),[f,v]=(0,s.useState)(!1),N=()=>{try{const e=localStorage.getItem("localWorkouts");return e?JSON.parse(e):[]}catch{return[]}};return(0,s.useEffect)((()=>{(async()=>{v(!0);try{let r=[];if(t&&e){const t=(0,l.P)((0,l.rJ)(o.A,"workouts"),(0,l._M)("userId","==",e.sub),(0,l.My)("timestamp","desc"));r=(await(0,l.GG)(t)).docs.map((e=>e.data()))}const s=N();j([...r,...s])}catch(r){console.error("Error fetching workouts: ",r),alert("There was an error fetching your workouts. Please try again.")}finally{v(!1)}})(),(async()=>{const r=localStorage.getItem("gymapp_settings");if(r){const e=JSON.parse(r);w(e.unit||"kg")}if(t&&e)try{const t=(0,l.H9)(o.A,"settings",e.sub),r=await(0,l.x7)(t);if(r.exists()){const e=r.data();w(e.unit||"kg")}}catch(s){console.error("Error fetching user settings:",s)}})()}),[t,e]),r?(0,n.jsx)("p",{className:"text-center text-gray-500",children:"Checking authentication..."}):(0,n.jsx)("div",{className:"max-w-2xl mx-auto p-4",children:(0,n.jsxs)("div",{className:"bg-white dark:bg-gray-900 border dark:border-gray-700 rounded-xl shadow-lg p-6 transition-all",children:[!t&&(0,n.jsxs)("div",{className:"bg-yellow-100 border-l-4 border-yellow-500 text-yellow-700 p-4 mb-4 rounded-md",children:[(0,n.jsx)("p",{className:"font-semibold",children:"You are not logged in."}),(0,n.jsx)("p",{className:"text-sm",children:"Your workouts will be saved locally but not to the cloud."})]}),(0,n.jsxs)("form",{onSubmit:async r=>{r.preventDefault();const s="Other"===i?d.trim():i;if(!s||!g||!h||!x)return;const a={exercise:s,sets:g,reps:h,weight:x,weightUnit:y,timestamp:Date.now(),userId:(null===e||void 0===e?void 0:e.sub)||null};if(t&&e)try{await(0,l.gS)((0,l.rJ)(o.A,"workouts"),a)}catch(w){console.error("Error saving workout:",w),alert("There was an error saving your workout. Please try again.")}else{const e=[a,...N()];n=e,localStorage.setItem("localWorkouts",JSON.stringify(n))}var n;j((e=>[a,...e])),c(""),u(""),m(""),b(""),p("")},className:"space-y-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block font-medium mb-1",children:"Exercise"}),(0,n.jsxs)("select",{value:i,onChange:e=>c(e.target.value),className:"w-full border rounded-md p-2 bg-white dark:bg-gray-800",children:[(0,n.jsx)("option",{value:"",children:"Select Exercise"}),(0,n.jsx)("option",{value:"Bench Press",children:"Bench Press"}),(0,n.jsx)("option",{value:"Squat",children:"Squat"}),(0,n.jsx)("option",{value:"Deadlift",children:"Deadlift"}),(0,n.jsx)("option",{value:"Other",children:"Other"})]})]}),"Other"===i&&(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block font-medium mb-1",children:"Custom Exercise"}),(0,n.jsx)("input",{type:"text",value:d,onChange:e=>u(e.target.value),className:"w-full border rounded-md p-2 bg-white dark:bg-gray-800"})]}),(0,n.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block font-medium mb-1",children:"Sets"}),(0,n.jsx)("input",{type:"number",value:g,onChange:e=>m(e.target.value),className:"w-full border rounded-md p-2 bg-white dark:bg-gray-800"})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{className:"block font-medium mb-1",children:"Reps"}),(0,n.jsx)("input",{type:"number",value:h,onChange:e=>b(e.target.value),className:"w-full border rounded-md p-2 bg-white dark:bg-gray-800"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("label",{className:"block font-medium mb-1",children:["Weight (",y,")"]}),(0,n.jsx)("input",{type:"number",value:x,onChange:e=>p(e.target.value),className:"w-full border rounded-md p-2 bg-white dark:bg-gray-800"})]}),(0,n.jsxs)("div",{className:"flex gap-4",children:[(0,n.jsx)("button",{type:"submit",className:"bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600",children:"Add Workout"}),(0,n.jsx)("button",{type:"button",onClick:()=>{c(""),u(""),m(""),b(""),p("")},className:"bg-gray-300 text-black px-4 py-2 rounded hover:bg-gray-400",children:"Reset"}),(0,n.jsx)("button",{type:"button",onClick:async()=>{if(window.confirm("Are you sure you want to delete all workout logs?"))try{if(t&&e){const t=(0,l.P)((0,l.rJ)(o.A,"workouts"),(0,l._M)("userId","==",e.sub)),r=(await(0,l.GG)(t)).docs.map((e=>(0,l.kd)((0,l.H9)(o.A,"workouts",e.id))));await Promise.all(r)}localStorage.removeItem("localWorkouts"),j([])}catch(r){console.error("Error deleting workouts:",r),alert("Error deleting workouts.")}},className:"bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600 ml-auto",children:"Clear All"})]})]}),(0,n.jsx)("hr",{className:"my-6 border-gray-300 dark:border-gray-600"}),(0,n.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Workout Log"}),0===k.length?(0,n.jsx)("p",{className:"text-gray-500",children:"No workouts logged yet."}):(0,n.jsx)("ul",{className:"space-y-2",children:k.map(((e,t)=>(0,n.jsxs)("li",{className:"p-4 border rounded-md bg-gray-50 dark:bg-gray-800 dark:border-gray-700",children:[(0,n.jsx)("p",{className:"font-medium text-lg",children:e.exercise}),(0,n.jsxs)("p",{className:"text-sm",children:[e.sets," sets \xd7 ",e.reps," reps @ ",e.weight,e.weightUnit]}),(0,n.jsx)("p",{className:"text-xs text-gray-500",children:new Date(e.timestamp).toLocaleString()})]},t)))})]})})}}}]);
//# sourceMappingURL=816.1d9c04cc.chunk.js.map